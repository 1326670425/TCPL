# 第七章 输入与输出  

- printf()函数转换说明，在字符 `%` 和转换字符中间可能一次出现下列组成部分：  
  - 负号，指定被转换的参数按照左对齐的形式输出。  
  - 数，指定最小字段宽度。多余字符位置用空格填充。  
  - 小数点，用于将字段宽度和精度分开。  
  - 数，指定精度，即指定字符串中要打印的最大字符数、浮点数小数点后的位数、整型最少输出的数字数目。  
  - 字母h或l，h表示将整数作为 `short` 类型打印，字母l表示将整数作为 `long` 类型打印。  

- 转换字符 `%g`： `double` 类型，如果指数小于-4或大于等于精度，则用 `%e` 或 `%E` 格式输出，否则用 `%f` 格式输出。尾部的0或小数点不打印。  

- 在转换说明中，宽度或精度可以用星号 * 表示，这时，宽度或精度的值通过转换下一参数（必须是 `int` 类型）来计算。例如，为了从字符串s中打印最多max个字符，可以这样做：  
  
  ` printf("%.*s", max, s); `

- 变长参数列表遍历。
  - va_list 类型用于声明一个变量，该变量将依次引用各参数。  
  - 宏 va_start 将 va_list 类型初始化为指向第一个无名参数的指针。  
  - 每次调用 va_arg，该函数将会返回一个参数，并将指针指向下一个参数。 va_arg 使用一个类型名来决定返回的对象类型、指针移动步长。  
  - 函数返回之前调用 va_end，以完成一些必要的清理工作。  

- 简化版printf函数：

  ``` C  
  #include<stdio.h>
  #include<ctype.h>
  
  #define MAXLINE 100
  #define OCTLEN 6
  
  int main(){
    int c, pos;
    int inc(int pos, int n);
  
    pos = 0;
    while((c = getchar()) != EOF){
          if(iscntrl(c) || c == ' '){// 寻找非显示字符——删除控制符（0177）和普通控制字符（040）
              pos = inc(pos, OCTLEN);// 长字符截断
              printf(" \\%03o ", c);
              if(c == '\n'){
                  pos = 0;
                  putchar('\n');
              }
          }else{
              pos = inc(pos, 1);
              putchar(c);
          }
      }
    return 0;
  }
  
  int inc(int pos, int n){
      if(pos + n < MAXLINE)
          return pos + n;
      else{// 超过每行最大字符数，重新开始一行
          putchar('\n');
          return n;
      }
  }
  ```  

- scanf函数，如果转换说明中有赋值禁止字符 `*`，则跳过该输入字段，不进行赋值。且scanf会忽略格式串中的空格和制表符，此外，读取输入值时，将跳过空白符（空格，制表，换行等等）。该函数返回读取到的输入项的个数。  

- gets函数在读取字符串时将删除结尾的换行符，puts函数在写入字符串时将在结尾处添加一个换行符。  

- ferror在发生错误时返回非0值，fputs在发生错误时返回 `EOF` ，其他情况返回非负值。  

